---
title: "Class 5: Data Viz with ggplot"
author: "Paul Brencick (PID:A17668863)"
format: pdf
toc: true
---

## Background

Wow we have so many *ways* to create a **plot** in R! These include so-called "base R" (like `plot()`) and add on packages like **ggplot2**.

We are going to create the same plot with the 2 different graphics systems. We are able to use the inbuilt `cars` dataset:

```{r}
head(cars)
```

Using "base R" we are able to simple do:
```{r}
plot(cars)
```

Now lets make a ggplot instead. However, first we need to install the package using `install.packages("ggplot2")`

> **N.B.** We should never run install.packages in a code chunk otherwise it will be re-installed needlessly every time we render to check. 

Every time we need to use an add-on, we need to load it up via a call to `library()`

```{r}
library(ggplot2)
ggplot(cars)
```

Every ggplot needs 3 things

1. The **data** (i.e things we are going to plot as a data.frame)
2. The **aes** or aesthetics which map the data to the plot
3. The **geom_** or geometry (i.e the type of plot)

```{r}
ggplot(cars) +
  aes(x=speed, y=dist) +
  geom_point() +
  geom_line()
```

```{r}
ggplot(cars) +
  aes(x=speed, y=dist) +
  geom_point() +
  geom_smooth(method="lm", se=FALSE) +
  labs(x="Speed(mph)",
       y="Distance(ft)",
       title="Stopping Distance of old Cars") +
  theme_bw()
```



## Gene Expression Plot
Read some data on the effects of GLP-1 inhibitor (drug) on gene expression values:

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```

Version 1 plot - start simple by getting some data on the page.

```{r}
ggplot(genes) +
  aes(x=Condition1, y=Condition2) +
  geom_point(col="purple", alpha=0.2)
```

Lets color by `State` up, down, or no change.
```{r}
table(genes$State)
```

```{r}
ggplot(genes) +
  aes(x=Condition1, y=Condition2, col=State) +
  geom_point() +
  scale_color_manual(values=c("blue","gray","red")) +
  labs(x="Control (before drug)",
       y="Activity after Drug",
       title="Effects of GLP-1 Inhibitor on Gene Expression") +
  theme_bw()
```

## Going further with gapmider

Now, lets explore the famous `gapmider` dataset via some custom plots.

```{r}
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
head(gapminder)
```

> Q. How many rows does this dataset have?

```{r}
nrow(gapminder)
```

> Q. How many different continents are in this dataset? 

```{r}
table(gapminder$continent)
```

Version 1 plot - gdpPercap vs LifeExp for all rows

```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp,col=continent) +
  geom_point(alpha=0.5) +
  labs(x="Average GDP per Person",
       y="Average Life Expectancy",
       title="GDP per Capita vs. Life Expectancy") +
  theme_bw()
```

I want to see a plot for each continent - in ggplot lingo this is called "faceting"

```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp,col=continent) +
  geom_point(alpha=0.5) +
  facet_wrap(~continent) +
  theme_bw()
```

## First look at the dplyer package

Another add-on package with a function called `filter()` which I want to use.

```{r}
library(dplyr)
```

```{r}
filter(gapminder, year==2007,country=="Vietnam")
```

```{r}
imput <- filter(gapminder, year==1977 | year ==2007)
```

```{r}
ggplot(imput) +
  aes(gdpPercap, lifeExp, col=continent) +
    facet_wrap(~year) +
  geom_point(alpha=0.5) +
  theme_bw()
```


